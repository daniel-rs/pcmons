import string, os

class VulnerabilityMonitor:
    '''
    Class for Vulnerability Monitoring based on Tiger
    '''
    vulnerability = {'warn':0, 'fail':""}
	
	def __init__(self):
        self.server = '150.162.63.32'
	
    def get_vulnerability_info(self):	
		warn = "WARN"
		fail = "FAIL"
		
		#defined for each scan
		log_path = "/var/log/tiger" 
		
		files = os.listdir(log_path)
		log_name = log_path + "/" + files[0]
		
		f = open(log_name, 'r')
		line = f.readline()
		
		warn_count = 0
		fail_count = 0
		
		while line:
			if string.find(line, warn) != -1:
				warn_count += 1
			else if string.find(line, fail):
				fail_count += 1
			line = f.readline()
			
		self.vulnerability['warn'] = warn_count
		self.vulnerability['fail'] = fail_count
		
        return self.vulnerability

if __name__=="__main__":
    vulnerabilityMon = VulnerabilityMonitor()
    print vulnerabilityMon.get_vulnerability_info()
